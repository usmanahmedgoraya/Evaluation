import Head from "next/head";
import { StaticImageData } from "next/image";
import { useRouter } from "next/router";
import { useEffect, useState } from "react";
import { Col, Row } from "reactstrap";
import bg1 from "../../src/assets/images/bg/bg1.jpg";
import bg2 from "../../src/assets/images/bg/bg2.jpg";
import bg3 from "../../src/assets/images/bg/bg3.jpg";
import bg4 from "../../src/assets/images/bg/bg4.jpg";
import SalesChart from "../../src/components/dashboard/SalesChart";
import TopCards from "../../src/components/dashboard/TopCards";
import FullLayout from "../../src/layouts/FullLayout";
import useArticleStore from '../../zustand/article.zustand';

interface BlogDataItem {
    image: StaticImageData;
    title: string;
    subtitle: string;
    description: string;
    btnbg: string;
}


const BlogData: BlogDataItem[] = [
    {
        image: bg1,
        title: "This is simple blog",
        subtitle: "2 comments, 1 Like",
        description:
            "This is a wider card with supporting text below as a natural lead-in to additional content.",
        btnbg: "primary",
    },
    {
        image: bg2,
        title: "Lets be simple blog",
        subtitle: "2 comments, 1 Like",
        description:
            "This is a wider card with supporting text below as a natural lead-in to additional content.",
        btnbg: "primary",
    },
    {
        image: bg3,
        title: "Don't Lamp blog",
        subtitle: "2 comments, 1 Like",
        description:
            "This is a wider card with supporting text below as a natural lead-in to additional content.",
        btnbg: "primary",
    },
    {
        image: bg4,
        title: "Simple is beautiful",
        subtitle: "2 comments, 1 Like",
        description:
            "This is a wider card with supporting text below as a natural lead-in to additional content.",
        btnbg: "primary",
    },
];

const Dashboard: React.FC = () => {
    const { getAllArticles, getTotalStats, totalCountries, totalPages, totalSites, totalLanguages } = useArticleStore();
    const [loading, setLoading] = useState(false)
    const router = useRouter()
    useEffect(() => {
        let localAuth: any = localStorage.getItem('Auth')
        localAuth = JSON.parse(localAuth!);
        if (localAuth?.state?.isLoggedin) {
            router.push('/analytics/dashboard')
            setLoading(true);
            Promise.all([getAllArticles(1), getTotalStats()])
            setLoading(false);
        } else {
            router.push('/auth/login')
        }
    }, [])


    return (
        <div>
            <Head>
                <title>Xtreme Starter Next Js App</title>
                <meta name="description" content="Generated by create next app" />
                <link rel="icon" href="/favicon.ico" />
                <script src="https://cdn.tailwindcss.com"></script>
            </Head>
            <div className="overflow-x-hidden">
                {/***Top Cards***/}
                <FullLayout>
                    <Row>
                        <Col sm="6" lg="3">
                            <TopCards
                                bg="bg-light-success text-success"
                                title="Total"
                                subtitle="Total Articles"
                                earning={totalPages}
                                loading={loading}
                                icon="bi bi-file-break"
                            />
                        </Col>
                        <Col sm="6" lg="3">
                            <TopCards
                                bg="bg-light-danger text-danger"
                                title="Total languages"
                                subtitle="Total languages"
                                loading={loading}
                                earning={totalLanguages.length}
                                icon="bi bi-translate"
                            />
                        </Col>
                        <Col sm="6" lg="3">
                            <TopCards
                                bg="bg-light-warning text-warning"
                                title="Total Countries"
                                subtitle="Total Countries"
                                loading={loading}
                                earning={totalCountries.length}
                                icon="bi bi-globe-americas"
                            />
                        </Col>
                        <Col sm="6" lg="3">
                            <TopCards
                                bg="bg-light-info text-into"
                                title="Total Source"
                                subtitle="Total Source"
                                loading={loading}
                                earning={totalSites.length}
                                icon="bi bi-diagram-3"
                            />
                        </Col>
                    </Row>
                    {/***Sales & Feed***/}
                    <Row>
                        <Col sm="12" lg="12" xl="12" xxl="12">
                            <SalesChart />
                        </Col>
                        {/* <Col sm="12" lg="6" xl="5" xxl="4">
                            <Feeds />
                        </Col> */}
                    </Row>
                    {/***Blog Cards***/}
                    {/* <Row>
                        {articles?.map((blg: any) => (
                            <Col sm="6" lg="6" xl="4" key={blg.title}>
                                <Blog
                                    image={blg.image}
                                    title={blg.title}
                                    subtitle={blg.subtitle}
                                    text={blg.text}
                                    color={blg.btnbg}
                                    defaultImage={bg4}
                                    blog={blg}
                                />
                            </Col>
                        ))}
                    </Row> */}

                </FullLayout>
            </div>
        </div>
    );
}

export default Dashboard;
